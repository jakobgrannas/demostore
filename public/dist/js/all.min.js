var Ajax=function(){var e={},n={method:"GET",url:"",data:null,headers:{},beforeSend:null,successHandler:null,errorHandler:null},r=function(r){var t,a,o=new XMLHttpRequest,s=_.extend(n,r),d=e.toQueryParams(s.data);s.beforeSend instanceof Function&&s.beforeSend();var o=new XMLHttpRequest;if(o.onreadystatechange=function(){4===o.readyState&&(200===o.status&&s.errorHandler instanceof Function?s.successHandler(JSON.parse(this.responseText)):s.errorHandler instanceof Function&&s.errorHandler(JSON.parse(this.responseText)))},o.open(s.method,s.url,!0),s.headers)for(t in s.headers)a=s.headers[t],s.headers.hasOwnProperty(t)&&o.setRequestHeader(t,a);o.send(d)};return e.post=function(e){n.method="POST",n.headers={"Content-Type":"application/x-www-form-urlencoded"},r(e)},e.get=function(e){r(e)},e.toQueryParams=function(e){var n="";for(var r in e)e.hasOwnProperty(r)&&(""!==n&&(n+="&"),n+=r+"="+encodeURIComponent(e[r]));return n},e}();
function init(){var e=document.getElementById("subscribe-btn");e.addEventListener("click",subscribe)}function subscribe(e){e.preventDefault(),e.stopPropagation();var r=e.target,t=r.parentNode.querySelector("#email").value,s={email:t},n=function(e){e.data?showAlert("success",e.data.message):e.errorMessage&&showAlert("error",e.errorMessage)},a=function(){showAlert("error","Something went terribly wrong! Please try again.")},o=function(){showAlert("loading","Subscribing...")};Ajax.post({method:"POST",url:"newsletter/subscribe",data:s,beforeSend:o,successHandler:n,errorHandler:a})}function showAlert(e,r){var t=document.querySelectorAll(".alert.newsletter")[0];clearAlertClassList(t),t.classList.add(e),t.innerHTML=r}function clearAlertClassList(e){for(var r,t=["error","success","loading"],s=0;s<t.length;s++)r=t[s],e.classList.contains(r)&&e.classList.remove(r)}document.onload=init();